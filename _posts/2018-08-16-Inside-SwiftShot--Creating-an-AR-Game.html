---
layout: post
title:  "Inside SwiftShot: Creating an AR Game"
subtitle: "WWDC 2018"
date:   2018-08-16 00:26:34 -0000
background: '/img/posts/wwdc18.png'
---





<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Inside SwiftShot: Creating an AR Game</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Inside SwiftShot: Creating an AR Game</h1>
</header>
<section data-field="subtitle" class="p-summary">
WWDC 2018
</section>
<section data-field="body" class="e-content">
<section name="035f" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="b9ec" id="b9ec" class="graf graf--h3 graf--leading graf--title">Inside SwiftShot: Creating an AR Game</h3><h4 name="11cf" id="11cf" class="graf graf--h4 graf-after--h3 graf--subtitle"><a href="https://developer.apple.com/videos/play/wwdc2018/605/" data-href="https://developer.apple.com/videos/play/wwdc2018/605/" class="markup--anchor markup--h4-anchor" rel="noopener" target="_blank">WWDC 2018</a></h4><h3 name="8b7d" id="8b7d" class="graf graf--h3 graf-after--h4">SwiftShot Internals</h3><ul class="postList"><li name="85b5" id="85b5" class="graf graf--li graf-after--h3">Establishing a shared coordinate space</li><li name="2b4e" id="2b4e" class="graf graf--li graf-after--li">Networking and state sharing</li><li name="a6bf" id="a6bf" class="graf graf--li graf-after--li">Physics</li><li name="0e5e" id="0e5e" class="graf graf--li graf-after--li">Asset import and management</li><li name="1150" id="1150" class="graf graf--li graf-after--li">Flag simulation</li><li name="95ce" id="95ce" class="graf graf--li graf-after--li">Dynamic audio</li></ul><h3 name="37ac" id="37ac" class="graf graf--h3 graf-after--li">ARKit — Establishing a shared Coordinate Space</h3><ul class="postList"><li name="1f89" id="1f89" class="graf graf--li graf-after--h3">Image detection</li><li name="cfb9" id="cfb9" class="graf graf--li graf-after--li">Object detection</li><li name="7235" id="7235" class="graf graf--li graf-after--li">World Map sharing</li><li name="d283" id="d283" class="graf graf--li graf-after--li">iBeacons for fixed installations</li></ul><figure name="aa81" id="aa81" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 331px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.3%;"></div><img class="graf-image" data-image-id="1*XHge5QB9JisKWRndgSyEpA.png" data-width="3918" data-height="1854" src="https://cdn-images-1.medium.com/max/800/1*XHge5QB9JisKWRndgSyEpA.png"></div></figure><figure name="bea0" id="bea0" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 388px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 55.400000000000006%;"></div><img class="graf-image" data-image-id="1*0r_sS9sQFjvKzeYq7h-W5g.png" data-width="800" data-height="443" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*0r_sS9sQFjvKzeYq7h-W5g.png"></div></figure><h3 name="af7a" id="af7a" class="graf graf--h3 graf-after--figure">Sharing a World Map</h3><h4 name="2062" id="2062" class="graf graf--h4 graf-after--h3">1. Saving</h4><ul class="postList"><li name="705d" id="705d" class="graf graf--li graf-after--h4">First device scans area, captures features</li><li name="0483" id="0483" class="graf graf--li graf-after--li">Asks <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">ARSession</strong></code>for world map</li><li name="de2e" id="de2e" class="graf graf--li graf-after--li">Serializes to dist</li></ul><figure name="4fc2" id="4fc2" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 161px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 23.1%;"></div><img class="graf-image" data-image-id="1*3eumBjoy4kZo6FhvbJO_Sg.png" data-width="4684" data-height="1080" src="https://cdn-images-1.medium.com/max/800/1*3eumBjoy4kZo6FhvbJO_Sg.png"></div></figure><h4 name="26c6" id="26c6" class="graf graf--h4 graf-after--figure">2. Ad-hoc gaming</h4><p name="dafc" id="dafc" class="graf graf--p graf-after--h4"><strong class="markup--strong markup--p-strong">Share over network</strong></p><ul class="postList"><li name="29f0" id="29f0" class="graf graf--li graf-after--p">Peer-to-peer network connnection</li><li name="8740" id="8740" class="graf graf--li graf-after--li">Encrypt data in flight</li><li name="5963" id="5963" class="graf graf--li graf-after--li">UI guidance to aid delocalization</li></ul><h4 name="5bbb" id="5bbb" class="graf graf--h4 graf-after--li">3. Fixed installations</h4><ul class="postList"><li name="69bc" id="69bc" class="graf graf--li graf-after--h4">Prerecord world maps for specific installation areas</li><li name="9d7b" id="9d7b" class="graf graf--li graf-after--li">Distribute to managed devices</li><li name="1410" id="1410" class="graf graf--li graf-after--li">Use iBeacons to automatically select correct world map for each location</li></ul><h4 name="4638" id="4638" class="graf graf--h4 graf-after--li">4. Loading</h4><figure name="1037" id="1037" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 206px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.4%;"></div><img class="graf-image" data-image-id="1*9INU0c2v9erw0QqzJ7Sy4w.png" data-width="4686" data-height="1376" src="https://cdn-images-1.medium.com/max/800/1*9INU0c2v9erw0QqzJ7Sy4w.png"></div></figure><h4 name="9225" id="9225" class="graf graf--h4 graf-after--figure">5. Privacy</h4><p name="892c" id="892c" class="graf graf--p graf-after--h4"><code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">ARWorldMap</strong></code> <strong class="markup--strong markup--p-strong">uses features of the world around you</strong></p><ul class="postList"><li name="2cdf" id="2cdf" class="graf graf--li graf-after--p">No latitude/ longitude information</li><li name="300a" id="300a" class="graf graf--li graf-after--li">May include personally identifiable information</li></ul><p name="7d61" id="7d61" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Treat serialized </strong><code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">ARWorldMap</strong></code><strong class="markup--strong markup--p-strong"> as user-private data</strong></p><ul class="postList"><li name="646e" id="646e" class="graf graf--li graf-after--p">Encrypt at rest and in motion</li><li name="54a8" id="54a8" class="graf graf--li graf-after--li">Obtain user consent for extended usage</li></ul><h4 name="1587" id="1587" class="graf graf--h4 graf-after--li">6. ARAnchor</h4><p name="f3ef" id="f3ef" class="graf graf--p graf-after--h4"><code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">ARAnchor</strong></code><strong class="markup--strong markup--p-strong"> represents a location and orientation in the physical world</strong></p><ul class="postList"><li name="4cad" id="4cad" class="graf graf--li graf-after--p">ARKit adds anchors for planes, objects, and images</li><li name="22a7" id="22a7" class="graf graf--li graf-after--li">Also, created and added via API</li></ul><figure name="6fc6" id="6fc6" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 51px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 7.3%;"></div><img class="graf-image" data-image-id="1*SwQflkzEIl_zi2IlKaRUdQ.png" data-width="4682" data-height="340" src="https://cdn-images-1.medium.com/max/800/1*SwQflkzEIl_zi2IlKaRUdQ.png"></div></figure><figure name="a518" id="a518" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 378px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 54%;"></div><img class="graf-image" data-image-id="1*2BUBopqEpEPEd3x_WdBwIg.png" data-width="4804" data-height="2594" src="https://cdn-images-1.medium.com/max/800/1*2BUBopqEpEPEd3x_WdBwIg.png"></div></figure><h3 name="1c4f" id="1c4f" class="graf graf--h3 graf-after--figure">Networking with Multipeer Connectivity</h3><ul class="postList"><li name="c62c" id="c62c" class="graf graf--li graf-after--h3">Peer-to-peer connectivity, no central server</li><li name="b77c" id="b77c" class="graf graf--li graf-after--li">Encryption and authentication are built in</li><li name="a7b0" id="a7b0" class="graf graf--li graf-after--li">Advertisement and discovery</li><li name="4dd6" id="4dd6" class="graf graf--li graf-after--li">Device starting the game creates a session, starts advertising</li><li name="0ebb" id="0ebb" class="graf graf--li graf-after--li">Other devices see session listed in menu</li><li name="3bf8" id="3bf8" class="graf graf--li graf-after--li">User selects game to join<br>- Device sends request<br>- Advertising device accepts or denies</li><li name="ccf6" id="ccf6" class="graf graf--li graf-after--li">Once session set up, devices are peers in the network</li><li name="2d32" id="2d32" class="graf graf--li graf-after--li">API to send<br>- Data packets<br>- Resources as URLs<br>- Streams</li><li name="c077" id="c077" class="graf graf--li graf-after--li">UDP for transport</li></ul><figure name="aee5" id="aee5" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 380px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 54.2%;"></div><img class="graf-image" data-image-id="1*8sV6GyChzqj55tBj2yqrPw.png" data-width="4832" data-height="2620" src="https://cdn-images-1.medium.com/max/800/1*8sV6GyChzqj55tBj2yqrPw.png"></div></figure><figure name="d081" id="d081" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 216px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 30.9%;"></div><img class="graf-image" data-image-id="1*lBrIP5d814pxjY4IqsEh8g.png" data-width="4846" data-height="1496" src="https://cdn-images-1.medium.com/max/800/1*lBrIP5d814pxjY4IqsEh8g.png"></div></figure><h3 name="5e6b" id="5e6b" class="graf graf--h3 graf-after--figure">Physics</h3><ul class="postList"><li name="7756" id="7756" class="graf graf--li graf-after--h3">SceneKit physics</li><li name="0684" id="0684" class="graf graf--li graf-after--li">All peers run physics simulation</li><li name="5cf2" id="5cf2" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Server</strong> sends updates to client to ensure synchronization</li><li name="42fd" id="42fd" class="graf graf--li graf-after--li">Only <strong class="markup--strong markup--li-strong">game state </strong>relevant information is shared</li><li name="5ae0" id="5ae0" class="graf graf--li graf-after--li">Object scaled approximately 10x for better performance</li></ul><h3 name="0a15" id="0a15" class="graf graf--h3 graf-after--li">Physics Data Optimization</h3><figure name="2c85" id="2c85" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 256px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.6%;"></div><img class="graf-image" data-image-id="1*lkjFwTd05eDvRSWOMQtlKA.png" data-width="4618" data-height="1690" src="https://cdn-images-1.medium.com/max/800/1*lkjFwTd05eDvRSWOMQtlKA.png"></div><figcaption class="imageCaption"><strong class="markup--strong markup--figure-strong">Physics Data</strong></figcaption></figure><figure name="34ab" id="34ab" class="graf graf--figure graf-after--figure graf--trailing"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 505px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72.2%;"></div><img class="graf-image" data-image-id="1*EigfTY9-vQNxnInUBPnFJA.png" data-width="3917" data-height="2827" src="https://cdn-images-1.medium.com/max/800/1*EigfTY9-vQNxnInUBPnFJA.png"></div></figure></div></div></section><section name="665f" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="6940" id="6940" class="graf graf--figure graf--leading"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 172px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 24.6%;"></div><img class="graf-image" data-image-id="1*KaTgfWg-v8KzMvAo5I4RHw.png" data-width="4646" data-height="1142" src="https://cdn-images-1.medium.com/max/800/1*KaTgfWg-v8KzMvAo5I4RHw.png"></div><figcaption class="imageCaption"><strong class="markup--strong markup--figure-strong">Performance: Optimized</strong> BitStreamCodable</figcaption></figure><h3 name="2a47" id="2a47" class="graf graf--h3 graf-after--figure">Encoding — BitStream</h3><ul class="postList"><li name="948e" id="948e" class="graf graf--li graf-after--h3">Bit-packed encoding of values</li><li name="f43e" id="f43e" class="graf graf--li graf-after--li">Minimum size, fast serialization and deserialization</li><li name="158b" id="158b" class="graf graf--li graf-after--li">Purpose-built for network communications of binary data<br>- Not suitable for persistence<br>- Not robust in face of changing data scheme</li></ul><figure name="0d8b" id="0d8b" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 327px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 46.800000000000004%;"></div><img class="graf-image" data-image-id="1*tAVp3uzY1rfdgPz5E2WAmA.png" data-width="4654" data-height="2176" src="https://cdn-images-1.medium.com/max/800/1*tAVp3uzY1rfdgPz5E2WAmA.png"></div></figure><figure name="d5ae" id="d5ae" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 318px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45.5%;"></div><img class="graf-image" data-image-id="1*GyVk_3T8ru-V_YOgUQIgeQ.png" data-width="4522" data-height="2056" src="https://cdn-images-1.medium.com/max/800/1*GyVk_3T8ru-V_YOgUQIgeQ.png"></div></figure><figure name="e44a" id="e44a" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 387px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 55.300000000000004%;"></div><img class="graf-image" data-image-id="1*aBmLUuGG5_y-YVpgzZIyVg.png" data-width="4668" data-height="2582" src="https://cdn-images-1.medium.com/max/800/1*aBmLUuGG5_y-YVpgzZIyVg.png"></div></figure><figure name="e4df" id="e4df" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 347px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.6%;"></div><img class="graf-image" data-image-id="1*WCOyL5Lhee6nu2490di81A.png" data-width="4684" data-height="2322" src="https://cdn-images-1.medium.com/max/800/1*WCOyL5Lhee6nu2490di81A.png"></div></figure><figure name="8c9d" id="8c9d" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 197px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 28.1%;"></div><img class="graf-image" data-image-id="1*cC3iwxFRZny-g4q6-MS38A.png" data-width="4698" data-height="1322" src="https://cdn-images-1.medium.com/max/800/1*cC3iwxFRZny-g4q6-MS38A.png"></div></figure><h3 name="72f2" id="72f2" class="graf graf--h3 graf-after--figure">Combining Encodings</h3><ul class="postList"><li name="123b" id="123b" class="graf graf--li graf-after--h3">Physics data encoded in BitStreams</li><li name="959c" id="959c" class="graf graf--li graf-after--li">Other commands encoded with Swift Codable, binary property lists</li></ul><figure name="24e3" id="24e3" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 378px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 54%;"></div><img class="graf-image" data-image-id="1*ITBPdWfUQDgsEuKEga9F8A.png" data-width="4734" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*ITBPdWfUQDgsEuKEga9F8A.png"></div><figcaption class="imageCaption">How to combine</figcaption></figure><h3 name="16c2" id="16c2" class="graf graf--h3 graf-after--figure">Assets for Game Levels</h3><p name="8f98" id="8f98" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Use level of detail to optimize for different distance</strong></p><ul class="postList"><li name="5e40" id="5e40" class="graf graf--li graf-after--p">Nearby objects get chamfered edges on blocks</li><li name="e40d" id="e40d" class="graf graf--li graf-after--li">Distant objects get less detailed textures, fewer polygons</li></ul><p name="798e" id="798e" class="graf graf--p graf-after--li">Physics bodies are the same</p><ul class="postList"><li name="d02c" id="d02c" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Use predefined types (box, sphere, etc)</strong> wherever possible for performance</li><li name="17bb" id="17bb" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">SceneKit</strong></code> will build<strong class="markup--strong markup--li-strong"> convex hull</strong> if not otherwise specified</li></ul><figure name="7dab" id="7dab" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 307px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.9%;"></div><img class="graf-image" data-image-id="1*-8ccwDBoLSY5FJueeUx50Q.png" data-width="4596" data-height="2018" src="https://cdn-images-1.medium.com/max/800/1*-8ccwDBoLSY5FJueeUx50Q.png"></div></figure><h3 name="dc21" id="dc21" class="graf graf--h3 graf-after--figure">Flag Simulation</h3><ul class="postList"><li name="26ee" id="26ee" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">SceneKit static asset</strong></li><li name="a508" id="a508" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Swift class <br>- </strong>Build metal<br>- Apply results back to SceneKit model</li><li name="5c34" id="5c34" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Metal compute shader</strong><br>- Computes forces in a mesh<br>- Produces vertices and shadows</li></ul><figure name="686f" id="686f" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 405px; max-height: 580px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 143.2%;"></div><img class="graf-image" data-image-id="1*V7LSfnFfOliaZQKfOv_xBA.gif" data-width="405" data-height="580" src="https://cdn-images-1.medium.com/max/800/1*V7LSfnFfOliaZQKfOv_xBA.gif"></div></figure><h3 name="f67a" id="f67a" class="graf graf--h3 graf-after--figure">Audio in SwiftShot</h3><ul class="postList"><li name="beda" id="beda" class="graf graf--li graf-after--h3">Positions sounds in the world</li><li name="12ef" id="12ef" class="graf graf--li graf-after--li">Limit app size</li><li name="c5e2" id="c5e2" class="graf graf--li graf-after--li">Leverage MIDI instrument support from <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">AVFoundation</strong></code></li></ul><figure name="40b0" id="40b0" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 444px; max-height: 640px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 144.1%;"></div><img class="graf-image" data-image-id="1*F39fjF2Ax8bDoL8h1TXS1A.gif" data-width="444" data-height="640" src="https://cdn-images-1.medium.com/max/800/1*F39fjF2Ax8bDoL8h1TXS1A.gif"></div></figure><h3 name="a164" id="a164" class="graf graf--h3 graf-after--figure">Sample</h3><ul class="postList"><li name="1e3b" id="1e3b" class="graf graf--li graf-after--h3 graf--trailing"><a href="https://developer.apple.com/documentation/arkit/swiftshot_creating_a_game_for_augmented_reality" data-href="https://developer.apple.com/documentation/arkit/swiftshot_creating_a_game_for_augmented_reality" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Link</a></li></ul></div></div></section>
</section>